题目4：“给出网络重试场景下的一致性解决方案”

两台应用服务器，一台数据库服务器的环境下面，一笔支付交易，因为网络重试原因，导致支付请求重复发送，如何解决这一场景下幂等性问题，请给出解决方案。

解决方案：
    支付流程: 前端 -> 应用服务器(多) -> 数据库(单)
    1. 同一笔支付交易使用幂等的唯一流水 key. 重试请求使用相同的 key (可由前端保证)
        a.针对同一 key 的落库启用可串行化事务隔离级别
        b.对于 key 的操作采用 select for update
        c.使用分布式锁(依赖外部组件)
        d.使用异步队列(依赖外部组件)

    总结:
        以上方案本质上是将请求串行化处理, 其中select for update 和分布式锁可以根据实际情况将锁粒度降低到行级
